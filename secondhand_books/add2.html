<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@200&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">
    <title>新增商品頁面</title>
</head>
<style>
    textarea {
        resize: none;
    }

    .box {
        width: 400px;
        /* 固定寬度或最大寬度 */
        margin: auto;
        background-color: #f0f0f0;
        padding: 20px;
    }

    .error {
        font-size: 10px;
        color: red;
    }

    .img {
        width: 100px;
        height: 200px;
    }

    h1 {
        display: flex;
        justify-content: center;
        font-family: 'Noto Serif TC', serif;
    }

    .image {
        font-size: 100px;
        margin-left: 120px;
    }


    .clickimg {
        transform: transform 3s ease-in-out;
        cursor: pointer;
        color: #ccc;
    }

    .clickimg:hover {
        transform: scale(1.2);
        width: 100px;
        color: black;

    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
</style>

<body>
    <h1>新增頁面</h1>
    <div class="box">
        <form action="add2.php" method="POST" enctype="multipart/form-data">
            <div>
                <label for="mybook">書名:</label>
                <input name="s" type="text" placeholder="書名" id="mybook" class="form-control">
                <span class="error" id="bookerror"></span><br>

                <label for="myname">分類:</label>
                <!-- <input name="j" type="text" placeholder="分類" id="myname"> <span class="error" id="nameerror"></span> -->
                <select name="j" id="myname" class="form-select" aria-label="Default select example">
                    <option selected value="請選擇">請選擇</option>
                    <option value="文學與小說">文學與小說</option>
                    <option value="學術與專業">學術與專業</option>
                    <option value="藝術與設計">藝術與設計</option>
                    <option value="商業與經濟">商業與經濟</option>
                    <option value="青年與兒童">青年與兒童</option>
                    <option value="科學與科技">科學與科技</option>
                    <option value="歷史與人文">歷史與人文</option>
                    <option value="生活與旅遊">生活與旅遊</option>
                    <option value="教育與教學">教育與教學</option>
                    <option value="其他">其他</option>
                </select>
                <span class="error" id="nameerror"></span>
                <br>

                <label for="author">作者名字:</label>
                <input name="a" type="text" placeholder="作者名字" id="author" class="form-control">
                <span class="error" id="authorerror"></span>
                <br>

                <label for="price">價格:</label>
                <input name="b" type="number" min="0" placeholder="價格" id="price"
                    onkeyup="value=value.replace(/^(0+)|[^\d]+/g,'')"
                    oninput="if(value.length > 9) value = value.slice(0, 9)" class="form-control">
                <span class="error" id="priceerror"></span><br>

                <label for="quantity">數量:</label>
                <input name="c" type="number" min="0" oninput="if(value.length > 9) value = value.slice(0, 9)"
                    placeholder="數量" id="quantity" onkeyup="value=value.replace(/^(0+)|[^\d]+/g,'')"
                    class="form-control">
                <span class="error" id="quantityerror"></span><br>

                <!-- <input  name="g" type="text" placeholder="使用多久"><br> -->
                <label for="use">使用多久:</label>
                <select name="g" id="use" class="form-select">
                    <option selected value="請選擇">請選擇</option>
                    <option value="未拆封">未拆封</option>
                    <option value="一年內">一年內</option>
                    <option value="三年內">三年內</option>
                    <option value="五年以上">五年以上</option>
                </select>
                <span class="error" id="useerror"></span><br>

                <div>
                    <div class="img-wrap">
                        <label for="file1">上傳圖片:</label>
                        <input name="f" type="file" accept="image/*" placeholder="圖片" id="file1"
                            class="form-control form-control-lg"><br>
                        <label>預覽圖片:</label>
                        <div>
                            <img class=" clickimg  bi bi-image-fill image" id="img1" src="" width="100px"
                                height="150px">
                        </div>
                    </div>
                    <span class="error" id="file1error"></span>

                    <!--描述-->
                    <label for="describe">描述:</label>
                    <textarea class="form-control" name="t" id="describe" cols="30" rows="5"></textarea>
                    <span class="error" id="describeerror"></span><br>

                    <span>狀態:</span>
                    <input type="radio" name="e" value="上架" checked id="radio1" class="form-check-input">
                    <label for="radio1">上架</label>
                    <input class="form-check-input" type="radio" name="e" value="下架" id="radio2">
                    <label for="radio2">下架</label> <br>
                    <input type="submit" value="添加" id="addd">
                    <input type="button" value="取消" id="ano" onclick="goBack()">
                </div>
        </form>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script>
        // function goBack() {
        //     window.history.back();
        // };

        $(function () {
            $('#mybook').focus();
            $('.clickimg').on('click', function () {
                $('#file1').trigger('click');
            });
            $('#file1').on('change', function () {
                $('.clickimg').unbind('click');
                $('#img1').removeClass('clickimg');
            });

            $('#file1').on('change', function () {
                //預覽圖 ***重要
                const reader = new FileReader();
                // load事件表示FileReader物件已經把圖讀完了
                reader.addEventListener('load', event => {
                    // console.log(event.target);
                    // console.log(event.trigger.result)
                    $('#img1').attr('src', event.target.result);
                });
                reader.readAsDataURL(this.files[0]);
            });
            $('#addd').on('click', function (event) {
                $('#nameerror').html('');
                $('#bookerror').html('');
                $('#authorerror').html('');
                $('#priceerror').html('');
                $('#quantityerror').html('');
                $('#useerror').html('');
                $('#describeerror').html('');
                $('#file1error').html('');
                if ($('#myname').val() === "請選擇" || $('#mybook').val() === "" || $('#author').val() === "" || $('#price').val() <= 0 || $('#quantity').val() <= 0 || $('#use').val() === "請選擇") {
                    Swal.fire({
                        icon: 'error',
                        title: '錯誤',
                        text: '請輸入完整內容!',
                    });

                    if ($('#myname').val() === "請選擇") {
                        $('#nameerror').html('未輸入分類');
                    }
                    if ($('#mybook').val() === "") {
                        $('#bookerror').html('未輸入書名');
                    }
                    if ($('#author').val() === "") {
                        $('#authorerror').html('未輸入作者名字');
                    }
                    if ($('#price').val() <= 0) {
                        $('#priceerror').html('未輸入價格');
                    }
                    if ($('#quantity').val() <= 0) {
                        $('#quantityerror').html('未輸入數量');
                    }
                    if ($('#use').val() === "請選擇") {
                        $('#useerror').html('未輸入使用多久');
                    }
                    event.preventDefault(); // 阻止表單提交
                } else {
                    event.preventDefault();
                    Swal.fire({
                        position: 'center',
                        icon: 'success',
                        title: '資料新增成功',
                        showConfirmButton: false,
                        timer: 3000
                    }).then(function () {
                        // 延遲提交表單，例如延遲 3 秒
                        setTimeout(function () {
                            $('form').submit(); // 自動提交表單
                        }, 0); // 延遲時間，單位為毫秒
                    });
                }
            });

            $('#ano').on('click', function () {
                Swal.fire({
                    title: '是否要離開新增商品頁面?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: '確定',
                    cancelButtonText: '取消'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.history.back();
                    }
                });
            });
        });

    </script>
</body>

</html>